<h2 class="mb-3">Edici√≥n de tags</h2>

<h4> Tags Materia </h4>
<table class="table table-bordered" id="edit_table">
    <thead>
    <tr>
        <th scope="col">Tag</th>
        <th scope="col">Acciones</th>
    </tr>
    </thead>
    <tbody>
        <% @document.document_tags.each do |document_tag| %>
            <% if document_tag.tag.tag_type.name == "materia" %>
                <tr>
                    <td>
                        <%= document_tag.tag.name %>
                    </td>
                    <td>
                        <%= button_to document_tag, method: :delete, data: { confirm: 'Are you sure?', toggle:"modal", target:"#modal-center"}, class:"btn btn-outline-danger", onclick:"myFunction()"  do %>
                            <i class="fas fa-trash-alt"></i>
                        <% end %>
                    </td>
                </tr>
            <% end %>
        <% end %>
        <tr> 
            <% document_tag = DocumentTag.new %>
            <%= form_with(model: document_tag, local: true) do |form|%>
            <% if document_tag.errors.any? %>
                <div id="error_explanation">
                <h2><%= pluralize(document_tag.errors.count, "error") %> prohibited this document_tag from being saved:</h2>
                    <ul>
                    <% document_tag.errors.full_messages.each do |message| %>
                        <li><%= message %></li>
                    <% end %>
                    </ul>
                </div>
            <% end %>
            <td>
                <% tag_type = TagType.find_by(name: "materia") %>
                <%= form.hidden_field :document_id, value: @document.id %>
                <%= form.collection_select(:tag_id, Tag.where(tag_type_id: tag_type.id), :id, :name, {:prompt=>true}, {:class=>'form-control select2'}) %>
            <td>
            <%= form.submit "Agregar tag", class: 'btn btn-primary' %>
            </td>
            <% end %>
        </tr>
    </tbody>
</table>
<!-- Tags diferentes -->

<h4> Tags Tipo </h4>
<table class="table table-bordered" id="edit_table">
    <thead>
    <tr>
        <th scope="col">Tag</th>
        <th scope="col">Acciones</th>
    </tr>
    </thead>
    <tbody>
        <% @document.document_tags.each do |document_tag| %>
            <% if document_tag.tag.tag_type.name == "creacion" %>
                <tr>
                    <td>
                        <%= document_tag.tag.name %>
                    </td>
                    <td>
                        <%= button_to document_tag, method: :delete, data: { confirm: 'Are you sure?', toggle:"modal", target:"#modal-center"}, class:"btn btn-outline-danger", onclick:"myFunction()"  do %>
                            <i class="fas fa-trash-alt"></i>
                        <% end %>
                    </td>
                </tr>
            <% end %>
        <% end %>
        <tr> 
            <% document_tag = DocumentTag.new %>
            <%= form_with(model: document_tag, local: true) do |form|%>
            <% if document_tag.errors.any? %>
                <div id="error_explanation">
                <h2><%= pluralize(document_tag.errors.count, "error") %> prohibited this document_tag from being saved:</h2>
                    <ul>
                    <% document_tag.errors.full_messages.each do |message| %>
                        <li><%= message %></li>
                    <% end %>
                    </ul>
                </div>
            <% end %>
            <td>
                <% tag_type = TagType.find_by(name: "creacion") %>
                <%= form.hidden_field :document_id, value: @document.id %>
                <%= form.collection_select(:tag_id, Tag.where(tag_type_id: tag_type.id), :id, :name, {:prompt=>true}, {:class=>'form-control select2'}) %>
            <td>
            <%= form.submit "Agregar tag", class: 'btn btn-primary' %>
            </td>
            <% end %>
        </tr>
    </tbody>
</table>



<script>
    $('.select2').select2();
</script>

<style>

    .select2{
        width:100% !important;
    }
</style>
